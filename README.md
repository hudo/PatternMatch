Pattern matching helper class for c#